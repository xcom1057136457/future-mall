import{k as Z,d as B,r as C,M as st,O as ct,P as at,K as I,Q as it,R as N,H as rt,S as V,n as j,a as y,T as lt,t as dt,U as Q,V as ut,W as ft,X as ht,Y as O,Z as P,_ as S,$ as F,x as gt,a0 as vt,a1 as pt,l as mt,a2 as xt,a3 as yt,y as U,a4 as kt,a5 as X,f as _t,g as Tt,h as Ct,o as T,c as L,B as Y,F as R,b as K}from"./index-DMlscLwg.js";import{C as St}from"./index-Dc3sGD_2.js";function bt(){return Array(26).fill("").map((n,d)=>String.fromCharCode(65+d))}const[W,w]=Z("index-bar"),At={sticky:dt,zIndex:Q,teleport:[String,Object],highlightColor:String,stickyOffsetTop:ut(0),indexList:{type:Array,default:bt}},q=Symbol(W);var Lt=B({name:W,props:At,emits:["select","change"],setup(e,{emit:x,slots:n}){const d=C(),f=C(),l=C(""),h=st(),u=ct(d),{children:s,linkChildren:g}=at(q);let i;g({props:e});const G=I(()=>{if(it(e.zIndex))return{zIndex:+e.zIndex+1}}),J=I(()=>{if(e.highlightColor)return{color:e.highlightColor}}),b=(t,o)=>{for(let a=s.length-1;a>=0;a--){const r=a>0?o[a-1].height:0,c=e.sticky?r+e.stickyOffsetTop:0;if(t+c>=o[a].top)return a}return-1},$=t=>s.find(o=>String(o.index)===t),A=()=>{if(ht(d))return;const{sticky:t,indexList:o}=e,a=O(u.value),r=P(u),c=s.map(k=>k.getRect(u.value,r));let v=-1;if(i){const k=$(i);if(k){const p=k.getRect(u.value,r);e.sticky&&e.stickyOffsetTop?v=b(p.top-e.stickyOffsetTop,c):v=b(p.top,c)}}else v=b(a,c);l.value=o[v],t&&s.forEach((k,p)=>{const{state:m,$el:ot}=k;if(p===v||p===v-1){const _=ot.getBoundingClientRect();m.left=_.left,m.width=_.width}else m.left=null,m.width=null;if(p===v)m.active=!0,m.top=Math.max(e.stickyOffsetTop,c[p].top-a)+r.top;else if(p===v-1&&i===""){const _=c[v].top-a;m.active=_>0,m.top=_+r.top-c[p].height}else m.active=!1}),i=""},E=()=>{ft(A)};N("scroll",A,{target:u,passive:!0}),rt(E),V(()=>e.indexList,E),V(l,t=>{t&&x("change",t)});const tt=()=>e.indexList.map(t=>{const o=t===l.value;return y("span",{class:w("index",{active:o}),style:o?J.value:void 0,"data-index":t},[t])}),M=t=>{i=String(t);const o=$(i);if(o){const a=O(u.value),r=P(u),{offsetHeight:c}=document.documentElement;if(o.$el.scrollIntoView(),a===c-r.height){A();return}e.sticky&&e.stickyOffsetTop&&(S()===c-r.height?F(S()):F(S()-e.stickyOffsetTop)),x("select",o.index)}},z=t=>{const{index:o}=t.dataset;o&&M(o)},et=t=>{z(t.target)};let D;const nt=t=>{if(h.move(t),h.isVertical()){gt(t);const{clientX:o,clientY:a}=t.touches[0],r=document.elementFromPoint(o,a);if(r){const{index:c}=r.dataset;c&&D!==c&&(D=c,z(r))}}},H=()=>y("div",{ref:f,class:w("sidebar"),style:G.value,onClick:et,onTouchstartPassive:h.start},[tt()]);return j({scrollTo:M}),N("touchmove",nt,{target:f}),()=>{var t;return y("div",{ref:d,class:w()},[e.teleport?y(lt,{to:e.teleport},{default:()=>[H()]}):H(),(t=n.default)==null?void 0:t.call(n)])}}});const[Rt,wt]=Z("index-anchor"),It={index:Q};var Ot=B({name:Rt,props:It,setup(e,{slots:x}){const n=vt({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),d=C(),{parent:f}=pt(q);if(!f)return;const l=()=>n.active&&f.props.sticky,h=I(()=>{const{zIndex:s,highlightColor:g}=f.props;if(l())return mt(xt(s),{left:n.left?`${n.left}px`:void 0,width:n.width?`${n.width}px`:void 0,transform:n.top?`translate3d(0, ${n.top}px, 0)`:void 0,color:g})});return j({state:n,getRect:(s,g)=>{const i=P(d);return n.rect.height=i.height,s===window||s===document.body?n.rect.top=i.top+S():n.rect.top=i.top+O(s)-g.top,n.rect}}),()=>{const s=l();return y("div",{ref:d,style:{height:s?`${n.rect.height}px`:void 0}},[y("div",{style:h.value,class:[wt({sticky:s}),{[yt]:s}]},[x.default?x.default():e.index])])}}});const Pt=U(Ot),Bt=U(Lt);function $t(){return kt({url:"/getLocationList",method:"get"})}const zt=B({name:"Location",__name:"index",setup(e){const x=Tt(),n=C([]);async function d(){const f=Ct({message:"加载中...",duration:0});try{const{code:l,data:h}=await $t();l===200&&(n.value=h)}finally{f.close()}}return d(),(f,l)=>{const h=Pt,u=St,s=Bt;return T(),X(s,{"sticky-offset-top":46},{default:_t(()=>[(T(!0),L(R,null,Y(K(n),g=>(T(),L(R,{key:g.initial},[y(h,{index:g.initial},null,8,["index"]),(T(!0),L(R,null,Y(g.list,i=>(T(),X(u,{key:i.code,title:i.name,onClick:l[0]||(l[0]=()=>K(x).back())},null,8,["title"]))),128))],64))),128))]),_:1})}}});export{zt as default};
