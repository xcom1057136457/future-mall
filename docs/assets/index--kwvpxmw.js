import{h as j,d as $,r as C,C as nt,D as st,A as P,E as ct,G as F,H as it,J as X,a as x,T as at,t as rt,K as G,L as lt,M as dt,O as ut,P as B,Q as E,R as A,S as Y,k as ft,U as ht,V as gt,i as pt,W as mt,X as vt,l as J,c as L,u as I,e as xt,F as b,f as yt,N as kt,o as T,s as K,Y as _t}from"./index-CKOkzEEm.js";import{C as Tt}from"./index-rHlETXPH.js";import{u as Ct,a as St,s as Lt}from"./request-BVF7dvFX.js";import"./index-M4WKrI8b.js";import{u as Q}from"./use-expose-BihWGjHf.js";function bt(){return Array(26).fill("").map((o,d)=>String.fromCharCode(65+d))}const[U,O]=j("index-bar"),At={sticky:rt,zIndex:G,teleport:[String,Object],highlightColor:String,stickyOffsetTop:lt(0),indexList:{type:Array,default:bt}},W=Symbol(U);var wt=$({name:U,props:At,emits:["select","change"],setup(e,{emit:f,slots:o}){const d=C(),h=C(),r=C(""),g=Ct(),u=nt(d),{children:s,linkChildren:y}=st(W);let i;y({props:e});const S=P(()=>{if(ct(e.zIndex))return{zIndex:+e.zIndex+1}}),Z=P(()=>{if(e.highlightColor)return{color:e.highlightColor}}),w=(t,n)=>{for(let a=s.length-1;a>=0;a--){const l=a>0?n[a-1].height:0,c=e.sticky?l+e.stickyOffsetTop:0;if(t+c>=n[a].top)return a}return-1},z=t=>s.find(n=>String(n.index)===t),R=()=>{if(ut(d))return;const{sticky:t,indexList:n}=e,a=B(u.value),l=E(u),c=s.map(k=>k.getRect(u.value,l));let p=-1;if(i){const k=z(i);if(k){const m=k.getRect(u.value,l);e.sticky&&e.stickyOffsetTop?p=w(m.top-e.stickyOffsetTop,c):p=w(m.top,c)}}else p=w(a,c);r.value=n[p],t&&s.forEach((k,m)=>{const{state:v,$el:ot}=k;if(m===p||m===p-1){const _=ot.getBoundingClientRect();v.left=_.left,v.width=_.width}else v.left=null,v.width=null;if(m===p)v.active=!0,v.top=Math.max(e.stickyOffsetTop,c[m].top-a)+l.top;else if(m===p-1&&i===""){const _=c[p].top-a;v.active=_>0,v.top=_+l.top-c[m].height}else v.active=!1}),i=""},D=()=>{dt(R)};F("scroll",R,{target:u,passive:!0}),it(D),X(()=>e.indexList,D),X(r,t=>{t&&f("change",t)});const q=()=>e.indexList.map(t=>{const n=t===r.value;return x("span",{class:O("index",{active:n}),style:n?Z.value:void 0,"data-index":t},[t])}),M=t=>{i=String(t);const n=z(i);if(n){const a=B(u.value),l=E(u),{offsetHeight:c}=document.documentElement;if(n.$el.scrollIntoView(),a===c-l.height){R();return}e.sticky&&e.stickyOffsetTop&&(A()===c-l.height?Y(A()):Y(A()-e.stickyOffsetTop)),f("select",n.index)}},N=t=>{const{index:n}=t.dataset;n&&M(n)},tt=t=>{N(t.target)};let H;const et=t=>{if(g.move(t),g.isVertical()){ft(t);const{clientX:n,clientY:a}=t.touches[0],l=document.elementFromPoint(n,a);if(l){const{index:c}=l.dataset;c&&H!==c&&(H=c,N(l))}}},V=()=>x("div",{ref:h,class:O("sidebar"),style:S.value,onClick:tt,onTouchstartPassive:g.start},[q()]);return Q({scrollTo:M}),F("touchmove",et,{target:h}),()=>{var t;return x("div",{ref:d,class:O()},[e.teleport?x(at,{to:e.teleport},{default:()=>[V()]}):V(),(t=o.default)==null?void 0:t.call(o)])}}});const[Rt,It]=j("index-anchor"),Ot={index:G};var Pt=$({name:Rt,props:Ot,setup(e,{slots:f}){const o=ht({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),d=C(),{parent:h}=gt(W);if(!h)return;const r=()=>o.active&&h.props.sticky,g=P(()=>{const{zIndex:s,highlightColor:y}=h.props;if(r())return pt(mt(s),{left:o.left?`${o.left}px`:void 0,width:o.width?`${o.width}px`:void 0,transform:o.top?`translate3d(0, ${o.top}px, 0)`:void 0,color:y})});return Q({state:o,getRect:(s,y)=>{const i=E(d);return o.rect.height=i.height,s===window||s===document.body?o.rect.top=i.top+A():o.rect.top=i.top+B(s)-y.top,o.rect}}),()=>{const s=r();return x("div",{ref:d,style:{height:s?`${o.rect.height}px`:void 0}},[x("div",{style:g.value,class:[It({sticky:s}),{[vt]:s}]},[f.default?f.default():e.index])])}}});const Bt=J(Pt),Et=J(wt);function $t(){return St({url:"/getLocationList",method:"get"})}const Vt=$({name:"Location",__name:"index",setup(e){const f=yt(),o=C([]);async function d(){const h=Lt({message:"加载中...",duration:0});try{const{code:r,data:g}=await $t();r===200&&(o.value=g)}finally{h.close()}}return d(),(h,r)=>{const g=kt,u=Bt,s=Tt,y=Et;return T(),L(b,null,[x(g,{title:"地址","left-text":"返回","left-arrow":"",placeholder:"","safe-area-inset-top":"",fixed:"","z-index":10,onClickLeft:r[0]||(r[0]=()=>I(f).back())}),x(y,{"sticky-offset-top":46},{default:xt(()=>[(T(!0),L(b,null,K(I(o),i=>(T(),L(b,{key:i.initial},[x(u,{index:i.initial},null,8,["index"]),(T(!0),L(b,null,K(i.list,S=>(T(),_t(s,{key:S.code,title:S.name,onClick:r[1]||(r[1]=()=>I(f).back())},null,8,["title"]))),128))],64))),128))]),_:1})],64)}}});export{Vt as default};
