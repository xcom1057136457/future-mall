import{l as j,d as $,r as C,L as st,M as ct,N as it,O as I,P as at,Q as V,J as rt,R as F,p as J,a as y,T as lt,t as dt,S as K,U as ut,V as ft,W as ht,X as O,Y as P,Z as S,_ as H,y as gt,$ as pt,a0 as vt,m as mt,a1 as xt,a2 as yt,z as Q,a3 as kt,a4 as X,g as _t,e as Tt,i as Ct,o as T,c as R,C as Y,F as b,u as Z}from"./index-DgQlD8nJ.js";import{C as St}from"./index-CTfCRGhE.js";function Lt(){return Array(26).fill("").map((o,d)=>String.fromCharCode(65+d))}const[U,w]=j("index-bar"),At={sticky:dt,zIndex:K,teleport:[String,Object],highlightColor:String,stickyOffsetTop:ut(0),indexList:{type:Array,default:Lt}},W=Symbol(U);var Rt=$({name:U,props:At,emits:["select","change"],setup(e,{emit:x,slots:o}){const d=C(),f=C(),l=C(""),h=st(),u=ct(d),{children:s,linkChildren:g}=it(W);let a;g({props:e});const q=I(()=>{if(at(e.zIndex))return{zIndex:+e.zIndex+1}}),G=I(()=>{if(e.highlightColor)return{color:e.highlightColor}}),L=(t,n)=>{for(let i=s.length-1;i>=0;i--){const r=i>0?n[i-1].height:0,c=e.sticky?r+e.stickyOffsetTop:0;if(t+c>=n[i].top)return i}return-1},B=t=>s.find(n=>String(n.index)===t),A=()=>{if(ht(d))return;const{sticky:t,indexList:n}=e,i=O(u.value),r=P(u),c=s.map(k=>k.getRect(u.value,r));let p=-1;if(a){const k=B(a);if(k){const v=k.getRect(u.value,r);e.sticky&&e.stickyOffsetTop?p=L(v.top-e.stickyOffsetTop,c):p=L(v.top,c)}}else p=L(i,c);l.value=n[p],t&&s.forEach((k,v)=>{const{state:m,$el:nt}=k;if(v===p||v===p-1){const _=nt.getBoundingClientRect();m.left=_.left,m.width=_.width}else m.left=null,m.width=null;if(v===p)m.active=!0,m.top=Math.max(e.stickyOffsetTop,c[v].top-i)+r.top;else if(v===p-1&&a===""){const _=c[p].top-i;m.active=_>0,m.top=_+r.top-c[v].height}else m.active=!1}),a=""},E=()=>{ft(A)};V("scroll",A,{target:u,passive:!0}),rt(E),F(()=>e.indexList,E),F(l,t=>{t&&x("change",t)});const tt=()=>e.indexList.map(t=>{const n=t===l.value;return y("span",{class:w("index",{active:n}),style:n?G.value:void 0,"data-index":t},[t])}),z=t=>{a=String(t);const n=B(a);if(n){const i=O(u.value),r=P(u),{offsetHeight:c}=document.documentElement;if(n.$el.scrollIntoView(),i===c-r.height){A();return}e.sticky&&e.stickyOffsetTop&&(S()===c-r.height?H(S()):H(S()-e.stickyOffsetTop)),x("select",n.index)}},M=t=>{const{index:n}=t.dataset;n&&z(n)},et=t=>{M(t.target)};let D;const ot=t=>{if(h.move(t),h.isVertical()){gt(t);const{clientX:n,clientY:i}=t.touches[0],r=document.elementFromPoint(n,i);if(r){const{index:c}=r.dataset;c&&D!==c&&(D=c,M(r))}}},N=()=>y("div",{ref:f,class:w("sidebar"),style:q.value,onClick:et,onTouchstartPassive:h.start},[tt()]);return J({scrollTo:z}),V("touchmove",ot,{target:f}),()=>{var t;return y("div",{ref:d,class:w()},[e.teleport?y(lt,{to:e.teleport},{default:()=>[N()]}):N(),(t=o.default)==null?void 0:t.call(o)])}}});const[bt,wt]=j("index-anchor"),It={index:K};var Ot=$({name:bt,props:It,setup(e,{slots:x}){const o=pt({top:0,left:null,rect:{top:0,height:0},width:null,active:!1}),d=C(),{parent:f}=vt(W);if(!f)return;const l=()=>o.active&&f.props.sticky,h=I(()=>{const{zIndex:s,highlightColor:g}=f.props;if(l())return mt(xt(s),{left:o.left?`${o.left}px`:void 0,width:o.width?`${o.width}px`:void 0,transform:o.top?`translate3d(0, ${o.top}px, 0)`:void 0,color:g})});return J({state:o,getRect:(s,g)=>{const a=P(d);return o.rect.height=a.height,s===window||s===document.body?o.rect.top=a.top+S():o.rect.top=a.top+O(s)-g.top,o.rect}}),()=>{const s=l();return y("div",{ref:d,style:{height:s?`${o.rect.height}px`:void 0}},[y("div",{style:h.value,class:[wt({sticky:s}),{[yt]:s}]},[x.default?x.default():e.index])])}}});const Pt=Q(Ot),$t=Q(Rt);function Bt(){return kt({url:"/getLocationList",method:"get"})}const Mt=$({name:"Location",__name:"index",setup(e){const x=Tt(),o=C([]);async function d(){const f=Ct({message:"加载中...",duration:0});try{const{code:l,data:h}=await Bt();l===200&&(o.value=h)}finally{f.close()}}return d(),(f,l)=>{const h=Pt,u=St,s=$t;return T(),X(s,{"sticky-offset-top":46},{default:_t(()=>[(T(!0),R(b,null,Y(Z(o),g=>(T(),R(b,{key:g.initial},[y(h,{index:g.initial},null,8,["index"]),(T(!0),R(b,null,Y(g.list,a=>(T(),X(u,{key:a.code,title:a.name,onClick:l[0]||(l[0]=()=>Z(x).back())},null,8,["title"]))),128))],64))),128))]),_:1})}}});export{Mt as default};
