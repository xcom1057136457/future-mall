import{aG as R,l as z,d as M,a5 as Q,n as _,O as T,a as e,z as L,aH as W,r as m,R as A,ax as V,J as X,w as ee,ak as te,a6 as N,t as I,U,Y as Z,V as ne,aB as ae,o as oe,a4 as le,g as ie,u as O,al as re}from"./index-DgD8RGzb.js";import"./index-Cq03etx5.js";import{F as se}from"./index-Be8d1MNx.js";import{B as Y}from"./index-CmJN1XRQ.js";/* empty css              */import{u as ce}from"./index-DG4QWMaz.js";import{C as de}from"./index-Ggf-oeUp.js";import"./index-DqNIfGfB.js";import{u as ue,T as he,a as j}from"./index-ByWCwioI.js";function q(t){const i=new Date(t*1e3);return`${i.getFullYear()}.${R(i.getMonth()+1)}.${R(i.getDate())}`}const ge=t=>(t/10).toFixed(t%10===0?0:1),J=t=>(t/100).toFixed(t%100===0?0:t%10===0?1:2),[pe,g,P]=z("coupon");var fe=M({name:pe,props:{chosen:Boolean,coupon:Q(Object),disabled:Boolean,currency:_("¥")},setup(t){const i=T(()=>{const{startAt:r,endAt:a}=t.coupon;return`${q(r)} - ${q(a)}`}),h=T(()=>{const{coupon:r,currency:a}=t;if(r.valueDesc)return[r.valueDesc,e("span",null,[r.unitDesc||""])];if(r.denominations){const n=J(r.denominations);return[e("span",null,[a]),` ${n}`]}return r.discount?P("discount",ge(r.discount)):""}),f=T(()=>{const r=J(t.coupon.originCondition||0);return r==="0"?P("unlimited"):P("condition",r)});return()=>{const{chosen:r,coupon:a,disabled:n}=t,l=n&&a.reason||a.description;return e("div",{class:g({disabled:n})},[e("div",{class:g("content")},[e("div",{class:g("head")},[e("h2",{class:g("amount")},[h.value]),e("p",{class:g("condition")},[a.condition||f.value])]),e("div",{class:g("body")},[e("p",{class:g("name")},[a.name]),e("p",{class:g("valid")},[i.value]),!n&&e(de,{class:g("corner"),modelValue:r},null)])]),l&&e("p",{class:g("description")},[l])])}}});const K=L(fe),[xe,S]=z("empty"),me={image:_("default"),imageSize:[Number,String,Array],description:String};var ve=M({name:xe,props:me,setup(t,{slots:i}){const h=()=>{const s=i.description?i.description():t.description;if(s)return e("p",{class:S("description")},[s])},f=()=>{if(i.default)return e("div",{class:S("bottom")},[i.default()])},r=ce(),a=s=>`${r}-${s}`,n=s=>`url(#${a(s)})`,l=(s,o,d)=>e("stop",{"stop-color":s,offset:`${o}%`,"stop-opacity":d},null),c=(s,o)=>[l(s,0),l(o,100)],u=s=>[e("defs",null,[e("radialGradient",{id:a(s),cx:"50%",cy:"54%",fx:"50%",fy:"54%",r:"297%",gradientTransform:"matrix(-.16 0 0 -.33 .58 .72)"},[l("#EBEDF0",0),l("#F2F3F5",100,.3)])]),e("ellipse",{fill:n(s),opacity:".8",cx:"80",cy:"140",rx:"46",ry:"8"},null)],v=()=>[e("defs",null,[e("linearGradient",{id:a("a"),x1:"64%",y1:"100%",x2:"64%"},[l("#FFF",0,.5),l("#F2F3F5",100)])]),e("g",{opacity:".8"},[e("path",{d:"M36 131V53H16v20H2v58h34z",fill:n("a")},null),e("path",{d:"M123 15h22v14h9v77h-31V15z",fill:n("a")},null)])],y=()=>[e("defs",null,[e("linearGradient",{id:a("b"),x1:"64%",y1:"97%",x2:"64%",y2:"0%"},[l("#F2F3F5",0,.3),l("#F2F3F5",100)])]),e("g",{opacity:".8"},[e("path",{d:"M87 6c3 0 7 3 8 6a8 8 0 1 1-1 16H80a7 7 0 0 1-8-6c0-4 3-7 6-7 0-5 4-9 9-9Z",fill:n("b")},null),e("path",{d:"M19 23c2 0 3 1 4 3 2 0 4 2 4 4a4 4 0 0 1-4 3v1h-7v-1l-1 1c-2 0-3-2-3-4 0-1 1-3 3-3 0-2 2-4 4-4Z",fill:n("b")},null)])],$=()=>e("svg",{viewBox:"0 0 160 160"},[e("defs",null,[e("linearGradient",{id:a(1),x1:"64%",y1:"100%",x2:"64%"},[l("#FFF",0,.5),l("#F2F3F5",100)]),e("linearGradient",{id:a(2),x1:"50%",x2:"50%",y2:"84%"},[l("#EBEDF0",0),l("#DCDEE0",100,0)]),e("linearGradient",{id:a(3),x1:"100%",x2:"100%",y2:"100%"},[c("#EAEDF0","#DCDEE0")]),e("radialGradient",{id:a(4),cx:"50%",cy:"0%",fx:"50%",fy:"0%",r:"100%",gradientTransform:"matrix(0 1 -.54 0 .5 -.5)"},[l("#EBEDF0",0),l("#FFF",100,0)])]),e("g",{fill:"none"},[v(),e("path",{fill:n(4),d:"M0 139h160v21H0z"},null),e("path",{d:"M80 54a7 7 0 0 1 3 13v27l-2 2h-2a2 2 0 0 1-2-2V67a7 7 0 0 1 3-13z",fill:n(2)},null),e("g",{opacity:".6","stroke-linecap":"round","stroke-width":"7"},[e("path",{d:"M64 47a19 19 0 0 0-5 13c0 5 2 10 5 13",stroke:n(3)},null),e("path",{d:"M53 36a34 34 0 0 0 0 48",stroke:n(3)},null),e("path",{d:"M95 73a19 19 0 0 0 6-13c0-5-2-9-6-13",stroke:n(3)},null),e("path",{d:"M106 84a34 34 0 0 0 0-48",stroke:n(3)},null)]),e("g",{transform:"translate(31 105)"},[e("rect",{fill:"#EBEDF0",width:"98",height:"34",rx:"2"},null),e("rect",{fill:"#FFF",x:"9",y:"8",width:"80",height:"18",rx:"1.1"},null),e("rect",{fill:"#EBEDF0",x:"15",y:"12",width:"18",height:"6",rx:"1.1"},null)])])]),C=()=>e("svg",{viewBox:"0 0 160 160"},[e("defs",null,[e("linearGradient",{x1:"50%",x2:"50%",y2:"100%",id:a(5)},[c("#F2F3F5","#DCDEE0")]),e("linearGradient",{x1:"95%",y1:"48%",x2:"5.5%",y2:"51%",id:a(6)},[c("#EAEDF1","#DCDEE0")]),e("linearGradient",{y1:"45%",x2:"100%",y2:"54%",id:a(7)},[c("#EAEDF1","#DCDEE0")])]),v(),y(),e("g",{transform:"translate(36 50)",fill:"none"},[e("g",{transform:"translate(8)"},[e("rect",{fill:"#EBEDF0",opacity:".6",x:"38",y:"13",width:"36",height:"53",rx:"2"},null),e("rect",{fill:n(5),width:"64",height:"66",rx:"2"},null),e("rect",{fill:"#FFF",x:"6",y:"6",width:"52",height:"55",rx:"1"},null),e("g",{transform:"translate(15 17)",fill:n(6)},[e("rect",{width:"34",height:"6",rx:"1"},null),e("path",{d:"M0 14h34v6H0z"},null),e("rect",{y:"28",width:"34",height:"6",rx:"1"},null)])]),e("rect",{fill:n(7),y:"61",width:"88",height:"28",rx:"1"},null),e("rect",{fill:"#F7F8FA",x:"29",y:"72",width:"30",height:"6",rx:"1"},null)])]),D=()=>e("svg",{viewBox:"0 0 160 160"},[e("defs",null,[e("linearGradient",{x1:"50%",x2:"50%",y2:"100%",id:a(8)},[c("#EAEDF1","#DCDEE0")])]),v(),y(),u("c"),e("path",{d:"m59 60 21 21 21-21h3l9 9v3L92 93l21 21v3l-9 9h-3l-21-21-21 21h-3l-9-9v-3l21-21-21-21v-3l9-9h3Z",fill:n(8)},null)]),G=()=>e("svg",{viewBox:"0 0 160 160"},[e("defs",null,[e("linearGradient",{x1:"50%",y1:"100%",x2:"50%",id:a(9)},[c("#EEE","#D8D8D8")]),e("linearGradient",{x1:"100%",y1:"50%",y2:"50%",id:a(10)},[c("#F2F3F5","#DCDEE0")]),e("linearGradient",{x1:"50%",x2:"50%",y2:"100%",id:a(11)},[c("#F2F3F5","#DCDEE0")]),e("linearGradient",{x1:"50%",x2:"50%",y2:"100%",id:a(12)},[c("#FFF","#F7F8FA")])]),v(),y(),u("d"),e("g",{transform:"rotate(-45 113 -4)",fill:"none"},[e("rect",{fill:n(9),x:"24",y:"52.8",width:"5.8",height:"19",rx:"1"},null),e("rect",{fill:n(10),x:"22.1",y:"67.3",width:"9.9",height:"28",rx:"1"},null),e("circle",{stroke:n(11),"stroke-width":"8",cx:"27",cy:"27",r:"27"},null),e("circle",{fill:n(12),cx:"27",cy:"27",r:"16"},null),e("path",{d:"M37 7c-8 0-15 5-16 12",stroke:n(11),"stroke-width":"3",opacity:".5","stroke-linecap":"round",transform:"rotate(45 29 13)"},null)])]),H=()=>{var s;if(i.image)return i.image();const o={error:D,search:G,network:$,default:C};return((s=o[t.image])==null?void 0:s.call(o))||e("img",{src:t.image},null)};return()=>e("div",{class:S()},[e("div",{class:S("image"),style:W(t.imageSize)},[H()]),h(),f()])}});const ye=L(ve),[Fe,p,w]=z("coupon-list"),be={code:_(""),coupons:N(),currency:_("¥"),showCount:I,emptyImage:String,enabledTitle:String,disabledTitle:String,disabledCoupons:N(),showExchangeBar:I,showCloseButton:I,closeButtonText:String,inputPlaceholder:String,exchangeMinLength:U(1),exchangeButtonText:String,displayedCouponIndex:U(-1),exchangeButtonLoading:Boolean,exchangeButtonDisabled:Boolean,chosenCoupon:{type:[Number,Array],default:-1}};var Ee=M({name:Fe,props:be,emits:["change","exchange","update:code"],setup(t,{emit:i,slots:h}){const[f,r]=ue(),a=m(),n=m(),l=m(0),c=m(0),u=m(t.code),v=T(()=>!t.exchangeButtonLoading&&(t.exchangeButtonDisabled||!u.value||u.value.length<t.exchangeMinLength)),y=()=>{const d=Z(a).height,F=Z(n).height+44;c.value=(d>F?d:V.value)-F},$=()=>{i("exchange",u.value),t.code||(u.value="")},C=o=>{ne(()=>{var d;return(d=f.value[o])==null?void 0:d.scrollIntoView()})},D=()=>e(ye,{image:t.emptyImage},{default:()=>[e("p",{class:p("empty-tip")},[w("noCoupon")])]}),G=()=>{if(t.showExchangeBar)return e("div",{ref:n,class:p("exchange-bar")},[e(se,{modelValue:u.value,"onUpdate:modelValue":o=>u.value=o,clearable:!0,border:!1,class:p("field"),placeholder:t.inputPlaceholder||w("placeholder"),maxlength:"20"},null),e(Y,{plain:!0,type:"primary",class:p("exchange"),text:t.exchangeButtonText||w("exchange"),loading:t.exchangeButtonLoading,disabled:v.value,onClick:$},null)])},H=()=>{const{coupons:o,chosenCoupon:d}=t,F=t.showCount?` (${o.length})`:"",B=(t.enabledTitle||w("enable"))+F,k=(b=[],E=0)=>b.includes(E)?b.filter(x=>x!==E):[...b,E];return e(j,{title:B},{default:()=>{var b;return[e("div",{class:p("list",{"with-bottom":t.showCloseButton}),style:{height:`${c.value}px`}},[o.map((E,x)=>e(K,{key:E.id,ref:r(x),coupon:E,chosen:Array.isArray(d)?d.includes(x):x===d,currency:t.currency,onClick:()=>i("change",Array.isArray(d)?k(d,x):x)},null)),!o.length&&D(),(b=h["list-footer"])==null?void 0:b.call(h)])]}})},s=()=>{const{disabledCoupons:o}=t,d=t.showCount?` (${o.length})`:"",F=(t.disabledTitle||w("disabled"))+d;return e(j,{title:F},{default:()=>{var B;return[e("div",{class:p("list",{"with-bottom":t.showCloseButton}),style:{height:`${c.value}px`}},[o.map(k=>e(K,{disabled:!0,key:k.id,coupon:k,currency:t.currency},null)),!o.length&&D(),(B=h["disabled-list-footer"])==null?void 0:B.call(h)])]}})};return A(()=>t.code,o=>{u.value=o}),A(V,y),A(u,o=>i("update:code",o)),A(()=>t.displayedCouponIndex,C),X(()=>{y(),C(t.displayedCouponIndex)}),()=>e("div",{ref:a,class:p()},[G(),e(he,{active:l.value,"onUpdate:active":o=>l.value=o,class:p("tab")},{default:()=>[H(),s()]}),e("div",{class:p("bottom")},[h["list-button"]?h["list-button"]():ee(e(Y,{round:!0,block:!0,type:"primary",class:p("close"),text:t.closeButtonText||w("close"),onClick:()=>i("change",Array.isArray(t.chosenCoupon)?[]:-1)},null),[[te,t.showCloseButton]])])])}});const we=L(Ee),$e=M({name:"CouponPop",__name:"index",props:{visible:{type:Boolean,default:!1},visibleModifiers:{}},emits:["update:visible"],setup(t){const i=ae(t,"visible"),h=m([{available:1,condition:`无门槛
最多优惠12元`,reason:"",value:150,name:"优惠券名称",startAt:1489104e3,endAt:1514592e3,valueDesc:"1.5",unitDesc:"元"}]),f=m(-1);function r(a){i.value=!1,f.value=a}return(a,n)=>{const l=we,c=re;return oe(),le(c,{show:i.value,"onUpdate:show":n[0]||(n[0]=u=>i.value=u),round:"",position:"bottom",style:{height:"90%","padding-top":"4px"}},{default:ie(()=>[e(l,{coupons:O(h),"chosen-coupon":O(f),onChange:r},null,8,["coupons","chosen-coupon"])]),_:1},8,["show"])}}});export{ye as E,$e as _};
